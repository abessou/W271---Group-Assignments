---
title: "Homework1"
author: "Charles Kekeh"
date: "Sunday, January 31, 2016"
output: pdf_document
---

```{r,include=FALSE}
library(ggplot2)
library(car)
library(boot)
library(pastecs)
library(car)
```
```{r}
load.data <- function(){
    load(file.path("./data", "birthweight_w271.rdata"))
    return (data)
}
```

Question 1
==========
```{r}
# Load the dataframe
data <- load.data()
```

Question 2
==========
```{r}
# Display summary information about the dataframe
print(str(data))
print(summary(data))
print(stat.desc(data))
```
There are 1388 obs. of 14 variables in the data.

Question 3
==========
```{r}
# Get summary statistics about the birthweight variable.
print(summary(data$bwght))
print(sum(is.nan(data$bwght)))
print(quantile(data$bwght, probs = c(.1, .5, .10, .25, .50, .75, .90, .95, .99, 1)))

# Plot the histogram of bwght at 15 bins
bwght.hist <- ggplot(data, aes(bwght)) + 
    theme(legend.position = "none") + 
    geom_histogram(fill = "Blue", colour = "Black", binwidth = (range(data$bwght)[2] - range(data$bwght)[1])/15) +
    labs(title = "Distribution of birthweight", x = "Birth Weight", y = "Fequency")

plot(bwght.hist)

# Plot the histogram of bwght at 30 bins
bwght.hist <- ggplot(data, aes(bwght)) + 
    theme(legend.position = "none") + 
    geom_histogram(fill = "Blue", colour = "Black") +
    labs(title = "Distribution of birthweight", x = "Birth Weight", y = "Fequency")

plot(bwght.hist)

# Plot the histogram of bwght at 60 bins
bwght.hist <- ggplot(data, aes(bwght)) + 
    theme(legend.position = "none") + 
    geom_histogram(fill = "Blue", colour = "Black", binwidth = (range(data$bwght)[2] - range(data$bwght)[1])/60) +
    labs(title = "Distribution of birthweight", x = "Birth Weight", y = "Fequency")

plot(bwght.hist)
```

Data observations:
------------------
Below are the outlier observations. There are babies with birthweights of 0 and over 200 ounces.
```{r}
print(sum(data$bwght == 0))
print(data$bwght[data$bwght > 200])
```
We should remove the zero baby weights from the data. They probably correspond to data entry issues.
We should also remove the single 271 ounces baby observation in the data set. For the purpose of a linear regression, that outlier data point may affect the regression.

Question 4
==========
```{r}
# Get summary statistics about the cigarettes smoked variable.
print(summary(data$cigs))
print(sum(is.nan(data$cigs)))
print(quantile(data$cigs, probs = c(.1, .5, .10, .25, .50, .75, .90, .95, .99, 1)))

# Plot the histogram of cigs at 15 bins
cigs.hist <- ggplot(data, aes(cigs)) + 
    theme(legend.position = "none") + 
    geom_histogram(fill = "Blue", colour = "Black", binwidth = (range(data$cigs)[2] - range(data$cigs)[1])/15) +
    labs(title = "Distribution of daily cigarette consumption", x = "Birth Weight", y = "Fequency")

plot(cigs.hist)

# Plot the histogram of cigs at 30 bins
cigs.hist <- ggplot(data, aes(cigs)) + 
    theme(legend.position = "none") + 
    geom_histogram(fill = "Blue", colour = "Black") +
    labs(title = "Distribution of daily cigarette consumption", x = "Birth Weight", y = "Fequency")

plot(cigs.hist)

# Plot the histogram of cigs at 60 bins
cigs.hist <- ggplot(data, aes(cigs)) + 
    theme(legend.position = "none") + 
    geom_histogram(fill = "Blue", colour = "Black", binwidth = (range(data$cigs)[2] - range(data$cigs)[1])/60) +
    labs(title = "Distribution of daily cigarette consumption", x = "Birth Weight", y = "Fequency")

plot(cigs.hist)
```

Data observations:
------------------

The histogram for the number of cigarettes smoked is positively skewed with a very high proportion of individuals smoking zero cigarettes per day during heir pregnancy.
There are no other visible signs of anomalies in the data.

Question 5:
===========
```{r}
# Create a scatterplot of cigarettes smoked per day vs baby birthweight
scatter.bwght.cigs <- ggplot(data, aes(cigs, bwght)) +
    geom_point(colour = "Blue", position = "jitter") +
    geom_smooth(method = "lm", colour = "Red") +
    labs(x = "Cigarettes Smoked Per Day", 
         y = "Infant Birthweight", 
         title = "Cigarettes Smoked Per Day Vs Infant Birthweight")
plot(scatter.bwght.cigs)
```
Based on the scatterplot and the fitted lm curve on it, it appears that only a very small amount of the variation of bwght will be explained by cigs. That's because the variation explained in the graph appears to be much lower than the variation of birthweights at any level of daily cigarette consumption in the scatterplot.

Question 6:
===========
```{r}
# Clean up the data based on previous observations
data <- data[data$bwght != 0 & data$bwght < 200, ]

# Now perform the OLS regression
simple.ols.cigs.bwght <- lm(bwght ~ cigs, data = data)
print(summary.lm(simple.ols.cigs.bwght))
plot(simple.ols.cigs.bwght)
```

Our null hypothesis is that there is no relationship between the cigs variable and the bwght variable.
The p-value of the f-statistic of the model is significant at 1.711e-08, indicating that we should reject the null hypothesis.
The model accounts for 2.32% of the variability in the variable bwght
That value is givent by a R^2 value of 0.02322 and a R value of 0.152 indicating a relatively small effect size
The model shows a negative coefficient for the variable cigs with a value of -0.508.
The Intercept and slope coefficent of the model are statistically significant.
Each cigarette smoked corresponds to a 0.5 ounce weight reduction. The standard error of the slope coefficient for the cigs variable is .0889.

Question 7
==========
```{r}
# Obtain descriptive statistics for the new variable
print(summary(data$faminc))
print(sum(is.nan(data$faminc)))
print(quantile(data$faminc, probs = c(.1, .5, .10, .25, .50, .75, .90, .95, .99, 1)))
print(stat.desc(data$faminc, basic=FALSE, norm = TRUE))

# Plot the histogram of faminc at 30 bins
faminc.hist <- ggplot(data, aes(faminc)) + 
    theme(legend.position = "none") + 
    geom_histogram(fill = "Blue", colour = "Black") +
    labs(title = "Distribution of Family Income", x = "Family Income", y = "Fequency")

plot(faminc.hist)

# Produce a scatterplot of bwght, cigs and faminc
scatterplotMatrix(~ bwght + cigs + faminc, data = data)
```

In the famiily income variable, it seems that the while all values below 20 were collected as exact values, values above may have been collected as ranges. For example, respondents may have ticked boxes such as 20-25, 25-20, 30-35, etc.,and in the final variable it seems the data is represented as the mean of the range.  It also seems strange that 65 is so far above the rest of the values. It seems that values above a certain number have been denoted as 65. While this is not ideal, we will proceed with these values as our observations.

Question 8:
==========
```{r}
#Introduce a new independent variable to the model
multiple.ols.cigs.faminc.bwght <- lm(bwght ~ cigs + faminc, data = data)
print(summary.lm(multiple.ols.cigs.faminc.bwght))
plot(multiple.ols.cigs.faminc.bwght)
```

Our null hypothesis is that there is no relationship between the cigs variable and the bwght and faminc variables.
The p-value of the f-statistic of the model is significant at 7.916e-10, indicating that we should reject the null hypothesis.
The model accounts for 3.00% of the variability in the variable bwght
That value is given by a R^2 value of 0.0300 and a R value of 0.173 indicating a relatively small effect size

The model shows a negative coefficient for the variable cigs with a value of -0.46.
It shows a positive coefficient for the variable faminc of 0.089.
The coefficents of the model are statistically significant.

Question 9
==========
The coefficient on cigs in the multiple regression means that for every additional
cigarette smoked per day by the pregnant mother during their maternity, and leaving
the income variable constant, the body weight of the infant children decreases by 0.460 onces.

In the simple regression, we saw that this coefficient was also negative and had a value of -0.508.

In the simple regression case, the coefficient on cigs meant that for every additional
cigarette smoked per day, indepedent of any other condition of the mother, the birth
weight of the infant was educed by -0.508 ounces.

In the multiple regression, the variance explained by the famic variable was captured in the residuals of the simple model and partially also in the coefficent of the cigs 
variable as we can suspect there is some correlation between the two variables.

Therefore the introduction of the additional variable faminc has reduced the contribution of the cigs variable to the infant body weight. We can hypothesise that there is some correlation between the numberof cigarettes smoked per day and the family income, where mothers at higher family income have better health habits and therefore smoke less.
And introducing the family income variable thus takes away some of the variance
explanation previously captured by the cigs variable.

Question 10
===========
The more negative cigs coefficient is that of the simpel model. It's value is -0.508 compared to the -0.46 value for the multiple regression model.
Our explaination for the difference as stated in Question 9 is that there is a correlation between the cigs variable and the faminc variable.